AWSTemplateFormatVersion: 2010-09-09
Metadata:
  Stupid:
    Stupid: Stupid
  'AWS::CloudFormation::Designer':
    79ee8c5c-c919-4d0f-91b8-4d7b665068a2:
      size:
        width: 60
        height: 60
      position:
        x: 60
        'y': 90
      z: 1
      embeds: []
    c64c3e2a-645c-453c-9f8a-f8a29eb7642f:
      size:
        width: 60
        height: 60
      position:
        x: 150
        'y': 90
      z: 1
      embeds: []
      dependson:
        - 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
    30665b18-1c16-4cc1-8ae7-4f71b6b66bd1:
      size:
        width: 60
        height: 60
      position:
        x: 60
        'y': 210
      z: 1
      embeds: []
      dependson:
        - 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
    9826eb5e-9f89-4a15-a614-3649ede94ece:
      size:
        width: 60
        height: 60
      position:
        x: 180
        'y': 210
      z: 1
      embeds: []
      dependson:
        - 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
    498c3101-f50d-4d07-9089-89280e24fd9c:
      size:
        width: 60
        height: 60
      position:
        x: 240
        'y': 90
      z: 1
      embeds: []
      dependson:
        - 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
    289c27ae-f6f9-466f-9178-d759f183065f:
      size:
        width: 60
        height: 60
      position:
        x: 60
        'y': 300
      z: 1
      embeds: []
      dependson:
        - 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
    f2456b96-4959-4209-8b39-1d3c6a52a0a4:
      size:
        width: 60
        height: 60
      position:
        x: 180
        'y': 300
      z: 1
      embeds: []
      dependson:
        - 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
    818db899-3f2c-4ad2-bd52-cfee272a41f7:
      size:
        width: 60
        height: 60
      position:
        x: 60
        'y': 420
      z: 1
      embeds: []
      dependson:
        - 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
    6dd778d5-8507-4d03-94a9-902f189da3bc:
      size:
        width: 60
        height: 60
      position:
        x: 180
        'y': 420
      z: 1
      embeds: []
      dependson:
        - 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
    582f5066-0cf9-41d3-aca3-e1e5d3d85a3e:
      size:
        width: 60
        height: 60
      position:
        x: 300
        'y': 210
      z: 1
      embeds: []
      dependson:
        - 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
    9aaf0919-2593-4f7a-aece-96a4d2919512:
      source:
        id: c64c3e2a-645c-453c-9f8a-f8a29eb7642f
      target:
        id: 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
      z: 11
    7f6c6eec-c603-4fcd-8f31-744bd894aeca:
      source:
        id: c64c3e2a-645c-453c-9f8a-f8a29eb7642f
        selector: 'g:nth-child(1) g:nth-child(4) g:nth-child(1) circle:nth-child(1)     '
        port: 'AWS::DependencyLink-*'
      target:
        id: 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
      z: 13
    cbb3d970-31bc-4562-adf5-ca3e5062803d:
      source:
        id: 498c3101-f50d-4d07-9089-89280e24fd9c
      target:
        id: 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
      z: 12
    6114c639-07da-487f-bd9a-b391f280a825:
      source:
        id: 30665b18-1c16-4cc1-8ae7-4f71b6b66bd1
      target:
        id: 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
      z: 13
    bdc72f57-7389-451b-8a5a-e1393cdfa240:
      source:
        id: 9826eb5e-9f89-4a15-a614-3649ede94ece
      target:
        id: 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
      z: 14
    b132a48c-80cb-4719-9c70-52b3fe38b8b8:
      source:
        id: 582f5066-0cf9-41d3-aca3-e1e5d3d85a3e
      target:
        id: 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
      z: 15
    077d69ed-6025-4c6f-93d1-159758526e8a:
      source:
        id: 289c27ae-f6f9-466f-9178-d759f183065f
      target:
        id: 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
      z: 16
    50bb7d56-2f72-4b39-91c0-f2c8e8c57fa3:
      source:
        id: f2456b96-4959-4209-8b39-1d3c6a52a0a4
      target:
        id: 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
      z: 17
    d156f463-fd39-4f8e-9020-9126d2c303ab:
      source:
        id: 818db899-3f2c-4ad2-bd52-cfee272a41f7
      target:
        id: 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
      z: 18
    67c13e55-04db-41f8-abd2-317686d74dd7:
      source:
        id: 6dd778d5-8507-4d03-94a9-902f189da3bc
      target:
        id: 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
      z: 19
Resources:
  AppSyncAPI:
    Type: 'AWS::AppSync::GraphQLApi'
    Properties:
      AuthenticationType: AMAZON_COGNITO_USER_POOLS
      LogConfig:
        CloudWatchLogsRoleArn: 'arn:aws:iam::797353049590:role/FAST-AppSync-MakeLogs'
        ExcludeVerboseContent: false
        FieldLogLevel: NONE
      Name: FAST App Sync API 2
      Tags: []
      UserPoolConfig:
        AwsRegion: us-east-1
        UserPoolId: us-east-1_z8wzHGNeO
        DefaultAction: "ALLOW"
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 79ee8c5c-c919-4d0f-91b8-4d7b665068a2
  AppSyncSchema:
    Type: 'AWS::AppSync::GraphQLSchema'
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DefinitionS3Location: >-
        ./schema.graphql
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 9826eb5e-9f89-4a15-a614-3649ede94ece
    DependsOn:
      - AppSyncAPI
  SourceEventRankingManagement:
    Type: 'AWS::AppSync::DataSource'
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      ServiceRoleArn: arn:aws:iam::797353049590:role/service-role/appsync-ds-lam-nuerz7-eventRankingManageme
      LambdaConfig:
        LambdaFunctionArn: >-
          arn:aws:lambda:us-east-1:797353049590:function:eventRankingManagement:Production
      Name: EventRankingManagement
      Type: AWS_LAMBDA
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 30665b18-1c16-4cc1-8ae7-4f71b6b66bd1
    DependsOn:
      - AppSyncAPI
  SourceScoutSessions:
    Type: 'AWS::AppSync::DataSource'
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      ServiceRoleArn: arn:aws:iam::797353049590:role/service-role/appsync-ds-lam-nuerz7-listScoutSessions
      LambdaConfig:
        LambdaFunctionArn: >-
          arn:aws:lambda:us-east-1:797353049590:function:listScoutSessions:Production
      Name: ScoutSessions
      Type: AWS_LAMBDA
    Metadata:
      'AWS::CloudFormation::Designer':
        id: c64c3e2a-645c-453c-9f8a-f8a29eb7642f
    DependsOn:
      - AppSyncAPI
  SourceStatsUpdater:
    Type: 'AWS::AppSync::DataSource'
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      ServiceRoleArn: arn:aws:iam::797353049590:role/service-role/appsync-ds-lam-nuerz7-updateStatistics
      LambdaConfig:
        LambdaFunctionArn: >-
          arn:aws:lambda:us-east-1:797353049590:function:updateStatistics:Production
      Name: StatsUpdater
      Type: AWS_LAMBDA
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 582f5066-0cf9-41d3-aca3-e1e5d3d85a3e
    DependsOn:
      - AppSyncAPI
  SourceTBAApiKey:
    Type: 'AWS::AppSync::DataSource'
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      ServiceRoleArn: arn:aws:iam::797353049590:role/service-role/appsync-ds-lam-nuerz7-RetrieveTBAKey
      LambdaConfig:
        LambdaFunctionArn: >-
          arn:aws:lambda:us-east-1:797353049590:function:RetrieveTBAKey:Production
      Name: TBAApiKey
      Type: AWS_LAMBDA
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 6dd778d5-8507-4d03-94a9-902f189da3bc
    DependsOn:
      - AppSyncAPI
  SourceTBALambda:
    Type: 'AWS::AppSync::DataSource'
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      ServiceRoleArn: arn:aws:iam::797353049590:role/service-role/appsync-ds-lam-nuerz7-FAST-TBA-Request-Han
      LambdaConfig:
        LambdaFunctionArn: >-
          arn:aws:lambda:us-east-1:797353049590:function:FAST-TBA-Request-Handler:Production
      Name: TBALambda
      Type: AWS_LAMBDA
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 818db899-3f2c-4ad2-bd52-cfee272a41f7
    DependsOn:
      - AppSyncAPI
  SourceFASTTable:
    Type: 'AWS::AppSync::DataSource'
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DynamoDBConfig:
        AwsRegion: us-east-1
        TableName: FASTTable
        UseCallerCredentials: false
        Versioned: false
      Name: FASTTable
      ServiceRoleArn: >-
        arn:aws:iam::797353049590:role/service-role/appsync-ds-ddb-nuerz7-FASTTable
      Type: AMAZON_DYNAMODB
    Metadata:
      'AWS::CloudFormation::Designer':
        id: f2456b96-4959-4209-8b39-1d3c6a52a0a4
    DependsOn:
      - AppSyncAPI

  IAMAppSyncToFASTTeamsRole:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument: |
        {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": [
                  "appsync.amazonaws.com"
                ]
              },
              "Action": "sts:AssumeRole"
            }
          ]
        }
      Policies:
        - PolicyDocument: |
            {
              "Version": "2012-10-17",
              "Statement": [
                {
                  "Effect": "Allow",
                  "Action": [
                      "dynamodb:DeleteItem",
                      "dynamodb:GetItem",
                      "dynamodb:PutItem",
                      "dynamodb:Query",
                      "dynamodb:Scan",
                      "dynamodb:UpdateItem"
                  ],
                  "Resource": [
                      "arn:aws:dynamodb:us-east-1:797353049590:table/FASTTeams",
                      "arn:aws:dynamodb:us-east-1:797353049590:table/FASTTeams/*"
                  ]
                }
              ]
            }
          PolicyName: AccessFASTScoutingTeams
      RoleName: FAST-AppSync2ScoutingTeamsAccess
      Tags:
        - Key: App
          Value: FAST

  SourceFASTTeams:
    Type: 'AWS::AppSync::DataSource'
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DynamoDBConfig:
        AwsRegion: us-east-1
        TableName: FASTTeams
        UseCallerCredentials: false
        Versioned: false
      Name: FASTTeams
      ServiceRoleArn: !GetAtt IAMAppSyncToFASTTeamsRole.Arn
      Type: AMAZON_DYNAMODB
    DependsOn:
      - AppSyncAPI

  SourceNone:
    Type: 'AWS::AppSync::DataSource'
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      Name: None
      Type: NONE
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 289c27ae-f6f9-466f-9178-d759f183065f
    DependsOn:
      - AppSyncAPI
  SourceTheBlueAllianceHTTP:
    Type: 'AWS::AppSync::DataSource'
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      HttpConfig:
        Endpoint: 'https://www.thebluealliance.com'
      Name: TheBlueAllianceHTTP
      Type: HTTP
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 498c3101-f50d-4d07-9089-89280e24fd9c
    DependsOn:
      - AppSyncAPI

  # FUNCTIONS
  FuncCheckEventExistence:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceFASTTable.Name
      FunctionVersion: 2018-05-29
      Name: CheckExistenceOfEvent
      RequestMappingTemplateS3Location: ./Functions/CheckEventExistenceRequest
      ResponseMappingTemplateS3Location: ./Functions/CheckEventExistenceResponse
  FuncCreateEventRanking:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceEventRankingManagement.Name
      FunctionVersion: 2018-05-29
      Name: CreateEventRanking
      RequestMappingTemplateS3Location: ./Functions/EventRankingManagementRequest
      ResponseMappingTemplateS3Location: ./Functions/EventRankingManagementResponse
  FuncCreateScoutSession:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceFASTTable.Name
      FunctionVersion: 2018-05-29
      Name: CreateScoutSession
      RequestMappingTemplateS3Location: ./Functions/CreateScoutSessionRequest
      ResponseMappingTemplateS3Location: ./Functions/CreateScoutSessionResponse
  FuncGetAllEvents:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceTheBlueAllianceHTTP.Name
      FunctionVersion: 2018-05-29
      Name: GetAllEvents
      RequestMappingTemplateS3Location: ./Functions/GetAllEventsRequest
      ResponseMappingTemplateS3Location: ./Functions/GetAllEventsResponse
  FuncGetSimpleEvent:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceTBALambda.Name
      FunctionVersion: 2018-05-29
      Name: GetSimpleEvent
      RequestMappingTemplateS3Location: ./Functions/GetSimpleEventRequest
      ResponseMappingTemplateS3Location: ./Functions/GetSimpleEventResponse
  FuncGetTeamsInEvent:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceTBALambda.Name
      FunctionVersion: 2018-05-29
      Name: GetTeamsInEvent
      RequestMappingTemplateS3Location: ./Functions/GetTeamsInEventRequest
      ResponseMappingTemplateS3Location: ./Functions/GetTeamsInEventResponse
  FuncAddTeamComment:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceFASTTable.Name
      FunctionVersion: 2018-05-29
      Name: AddTeamComment
      RequestMappingTemplateS3Location: ./Functions/AddTeamCommentRequest
      ResponseMappingTemplateS3Location: ./Functions/AddTeamCommentResponse
  FuncStashTBAKey:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceTBAApiKey.Name
      FunctionVersion: 2018-05-29
      Name: StashTBAKey
      RequestMappingTemplateS3Location: ./Functions/StashTBAKeyRequest
      ResponseMappingTemplateS3Location: ./Functions/StashTBAKeyResponse
  FuncUpdateScoutSessionStats:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceStatsUpdater.Name
      FunctionVersion: 2018-05-29
      Name: UpdateScoutSessionStats
      RequestMappingTemplateS3Location: ./Functions/UpdateScoutSessionStatsRequest
      ResponseMappingTemplateS3Location: ./Functions/UpdateScoutSessionStatsResponse
  FuncAuthenticate:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceFASTTeams.Name
      Description: This is to authenticate users whenever they try to access shared team resources. If they are not a member of the team they are trying to access, then deny them.
      FunctionVersion: 2018-05-29
      Name: Authenticate
      RequestMappingTemplateS3Location: ./Functions/AuthenticateRequest
      ResponseMappingTemplateS3Location: ./Functions/AuthenticateResponse

  # Resolvers for The Blue Alliance Universal Data
  ResolverListAvailableEvents:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: listAvailableEvents
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncStashTBAKey.FunctionId
          - !GetAtt FuncGetAllEvents.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Query
    # DependsOn:
    #   - FuncStashTBAKey
    #   - FuncGetAllEvents
  ResolverGetEvent:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: getEvent
      Kind: UNIT
      DataSourceName: !GetAtt SourceTBALambda.Name
      RequestMappingTemplateS3Location: ./Functions/GetEventRequest
      ResponseMappingTemplateS3Location: ./Functions/GetEventResponse
      TypeName: Query
  ResolverListTeams:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: listTeams
      Kind: UNIT
      DataSourceName: !GetAtt SourceTBALambda.Name
      RequestMappingTemplateS3Location: ./Functions/ListTeamsRequest
      ResponseMappingTemplateS3Location: ./Functions/ListTeamsResponse
      TypeName: Query
  ResolverGetTeam:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: getTeam
      Kind: UNIT
      DataSourceName: !GetAtt SourceTBALambda.Name
      RequestMappingTemplateS3Location: ./Functions/GetTeamRequest
      ResponseMappingTemplateS3Location: ./Functions/GetTeamResponse
      TypeName: Query
  ResolverListMatches:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: listMatches
      Kind: UNIT
      DataSourceName: !GetAtt SourceTBALambda.Name
      RequestMappingTemplateS3Location: ./Functions/ListMatchesRequest
      ResponseMappingTemplateS3Location: ./Functions/ListMatchesResponse
      TypeName: Query
  ResolverGetMatch:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: getMatch
      Kind: UNIT
      DataSourceName: !GetAtt SourceTBALambda.Name
      RequestMappingTemplateS3Location: ./Functions/GetMatchRequest
      ResponseMappingTemplateS3Location: ./Functions/GetMatchResponse
      TypeName: Query
  ResolverListEventOprs:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: listEventOprs
      Kind: UNIT
      DataSourceName: !GetAtt SourceTBALambda.Name
      RequestMappingTemplateS3Location: ./Functions/ListEventOprsRequest
      ResponseMappingTemplateS3Location: ./Functions/ListEventOprsResponse
      TypeName: Query
  ResolverListTeamEventStatuses:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: listTeamEventStatuses
      Kind: UNIT
      DataSourceName: !GetAtt SourceTBALambda.Name
      RequestMappingTemplateS3Location: ./Functions/ListTeamEventStatusesRequest
      ResponseMappingTemplateS3Location: ./Functions/ListTeamEventStatusesResponse
      TypeName: Query

  # Resolvers and functions for scouted team data calls
  # QUERIES
  FuncListTrackedEvents:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceFASTTable.Name
      FunctionVersion: 2018-05-29
      Name: ListTrackedEvents
      RequestMappingTemplateS3Location: ./Functions/ListTrackedEventsRequest
      ResponseMappingTemplateS3Location: ./Functions/ListTrackedEventsResponse
  ResolverListTrackedEvents:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: listTrackedEvents
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
          - !GetAtt FuncListTrackedEvents.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Query

  FuncGetEventRanking:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceFASTTable.Name
      FunctionVersion: 2018-05-29
      Name: GetEventRanking
      RequestMappingTemplateS3Location: ./Functions/GetEventRankingRequest
      ResponseMappingTemplateS3Location: ./Functions/GetEventRankingResponse
  ResolverGetEventRanking:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: getEventRanking
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
          - !GetAtt FuncGetEventRanking.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Query

  FuncListScoutedTeams:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceFASTTable.Name
      FunctionVersion: 2018-05-29
      Name: ListScoutedTeams
      RequestMappingTemplateS3Location: ./Functions/ListScoutedTeamsRequest
      ResponseMappingTemplateS3Location: ./Functions/ListScoutedTeamsResponse
  ResolverListScoutedTeams:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: listScoutedTeams
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
          - !GetAtt FuncListScoutedTeams.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Query

  FuncGetScoutedTeam:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceFASTTable.Name
      FunctionVersion: 2018-05-29
      Name: GetScoutedTeam
      RequestMappingTemplateS3Location: ./Functions/GetScoutedTeamRequest
      ResponseMappingTemplateS3Location: ./Functions/GetScoutedTeamResponse
  ResolverGetScoutedTeam:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: getScoutedTeam
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
          - !GetAtt FuncGetScoutedTeam.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Query

  FuncListTeamComments:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceFASTTable.Name
      FunctionVersion: 2018-05-29
      Name: ListTeamComments
      RequestMappingTemplateS3Location: ./Functions/ListTeamCommentsRequest
      ResponseMappingTemplateS3Location: ./Functions/ListTeamCommentsResponse
  ResolverListTeamComments:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: listTeamComments
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
          - !GetAtt FuncListTeamComments.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Query

  FuncListScoutSessions:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceFASTTable.Name
      FunctionVersion: 2018-05-29
      Name: ListScoutSessions
      RequestMappingTemplateS3Location: ./Functions/ListScoutSessionsRequest
      ResponseMappingTemplateS3Location: ./Functions/ListScoutSessionsResponse
  ResolverListScoutSessions:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: listScoutSessions
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
          - !GetAtt FuncListScoutSessions.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Query

  FuncGetScoutSession:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceFASTTable.Name
      FunctionVersion: 2018-05-29
      Name: GetScoutSession
      RequestMappingTemplateS3Location: ./Functions/GetScoutSessionRequest
      ResponseMappingTemplateS3Location: ./Functions/GetScoutSessionResponse
  ResolverGetScoutSession:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: getScoutSession
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
          - !GetAtt FuncGetScoutSession.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Query

  FuncListAllScoutSessions:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceScoutSessions.Name
      FunctionVersion: 2018-05-29
      Name: ListAllScoutSessions
      RequestMappingTemplateS3Location: ./Functions/ListAllScoutSessionsRequest
      ResponseMappingTemplateS3Location: ./Functions/ListAllScoutSessionsResponse
  ResolverListAllScoutSessions:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: listAllScoutSessions
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
          - !GetAtt FuncListAllScoutSessions.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Query

  FuncListScoutSessionsDelta:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceFASTTable.Name
      FunctionVersion: 2018-05-29
      Name: ListScoutSessionsDelta
      RequestMappingTemplateS3Location: ./Functions/ListScoutSessionsDeltaRequest
      ResponseMappingTemplateS3Location: ./Functions/ListScoutSessionsDeltaResponse
  ResolverListScoutSessionsDelta:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: listScoutSessionsDelta
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
          - !GetAtt FuncListScoutSessionsDelta.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Query

  ResolverListEnrolledScoutingTeams:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: listEnrolledScoutingTeams
      TypeName: Query
      Kind: UNIT
      DataSourceName: !GetAtt SourceFASTTeams.Name
      RequestMappingTemplateS3Location: ./Functions/ListEnrolledScoutingTeamsRequest
      ResponseMappingTemplateS3Location: ./Functions/ListEnrolledScoutingTeamsResponse
    DependsOn:
      - AppSyncSchema

  ######################################################################
  ######################################################################

  # MUTATIONS
  ResolverAddTrackedEvent:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: addTrackedEvent
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
          - !GetAtt FuncGetSimpleEvent.FunctionId
          - !GetAtt FuncGetTeamsInEvent.FunctionId
          - !GetAtt FuncCreateEventRanking.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Mutation

  FuncRemoveTrackedEvent:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceEventRankingManagement.Name
      FunctionVersion: 2018-05-29
      Name: RemoveTrackedEvent
      RequestMappingTemplateS3Location: ./Functions/RemoveTrackedEventRequest
      ResponseMappingTemplateS3Location: ./Functions/RemoveTrackedEventResponse
  ResolverRemoveTrackedEvent:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: removeTrackedEvent
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
          - !GetAtt FuncRemoveTrackedEvent.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Mutation

  FuncMoveRankedTeam:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceEventRankingManagement.Name
      FunctionVersion: 2018-05-29
      Name: MoveRankedTeam
      RequestMappingTemplateS3Location: ./Functions/MoveRankedTeamRequest
      ResponseMappingTemplateS3Location: ./Functions/MoveRankedTeamResponse
  ResolverMoveRankedTeam:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: moveRankedTeam
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
          - !GetAtt FuncMoveRankedTeam.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Mutation

  FuncSetTeamPicked:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceEventRankingManagement.Name
      FunctionVersion: 2018-05-29
      Name: SetTeamPicked
      RequestMappingTemplateS3Location: ./Functions/SetTeamPickedRequest
      ResponseMappingTemplateS3Location: ./Functions/SetTeamPickedResponse
  ResolverSetTeamPicked:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: setTeamPicked
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
          - !GetAtt FuncSetTeamPicked.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Mutation

  FuncUpdateScoutedTeam:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceFASTTable.Name
      FunctionVersion: 2018-05-29
      Name: UpdateScoutedTeam
      RequestMappingTemplateS3Location: ./Functions/UpdateScoutedTeamRequest
      ResponseMappingTemplateS3Location: ./Functions/UpdateScoutedTeamResponse
  ResolverUpdateScoutedTeam:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: updateScoutedTeam
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
          - !GetAtt FuncUpdateScoutedTeam.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Mutation

  ResolverAddTeamComment:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: addTeamComment
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
          - !GetAtt FuncCheckEventExistence.FunctionId
          - !GetAtt FuncAddTeamComment.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Mutation

  FuncRemoveTeamComment:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceFASTTable.Name
      FunctionVersion: 2018-05-29
      Name: RemoveTeamComment
      RequestMappingTemplateS3Location: ./Functions/RemoveTeamCommentRequest
      ResponseMappingTemplateS3Location: ./Functions/RemoveTeamCommentResponse
  ResolverRemoveTeamComment:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: removeTeamComment
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
          - !GetAtt FuncRemoveTeamComment.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Mutation

  ResolverCreateScoutSession:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: createScoutSession
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
          - !GetAtt FuncCheckEventExistence.FunctionId
          - !GetAtt FuncCreateScoutSession.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Mutation

  FuncRemoveScoutSession:
    Type: AWS::AppSync::FunctionConfiguration
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      DataSourceName: !GetAtt SourceFASTTable.Name
      FunctionVersion: 2018-05-29
      Name: RemoveScoutSession
      RequestMappingTemplateS3Location: ./Functions/RemoveScoutSessionRequest
      ResponseMappingTemplateS3Location: ./Functions/RemoveScoutSessionResponse
    Metadata:
      Stupid:
        Stupid: Stupid
  ResolverRemoveScoutSession:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: removeScoutSession
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
          - !GetAtt FuncRemoveScoutSession.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Mutation

  ResolverCreateScoutingTeam:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: createScoutingTeam
      Kind: UNIT
      DataSourceName: !GetAtt SourceFASTTeams.Name
      RequestMappingTemplateS3Location: ./Functions/CreateScoutingTeamRequest
      ResponseMappingTemplateS3Location: ./Functions/CreateScoutingTeamResponse
      TypeName: Mutation
    DependsOn:
      - AppSyncSchema
  ResolverScoutingTeamMembers:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: members
      Kind: UNIT
      DataSourceName: !GetAtt SourceFASTTeams.Name
      RequestMappingTemplateS3Location: ./Functions/ScoutingTeamMembersRequest
      ResponseMappingTemplateS3Location: ./Functions/ScoutingTeamMembersResponse
      TypeName: ScoutingTeam
    DependsOn:
      - AppSyncSchema


  # SUBSCRIPTIONS
  ResolverOnAddTrackedEvent:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: onAddTrackedEvent
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Subscription
  ResolverOnRemoveTrackedEvent:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: onRemoveTrackedEvent
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Subscription
  ResolverOnUpdateTeamRank:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: onUpdateTeamRank
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Subscription
  ResolverOnSetTeamPicked:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: onSetTeamPicked
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Subscription
  ResolverOnUpdateScoutedTeam:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: onUpdateScoutedTeam
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Subscription
  ResolverOnAddTeamComment:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: onAddTeamComment
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Subscription
  ResolverOnCreateScoutSession:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: onCreateScoutSession
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Subscription
  ResolverOnDeleteScoutSession:
    Type: AWS::AppSync::Resolver
    Properties:
      ApiId: !GetAtt AppSyncAPI.ApiId
      FieldName: onDeleteScoutSession
      Kind: PIPELINE
      PipelineConfig:
        Functions:
          - !GetAtt FuncAuthenticate.FunctionId
      RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
      ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
      TypeName: Subscription


  # Resolver NAME:
  #   Type: AWS::AppSync::Resolver
  #   Properties:
  #     ApiId: !GetAtt AppSyncAPI.ApiId
  #     FieldName: NAME
  #     Kind: PIPELINE
  #     PipelineConfig:
  #       Functions:
  #         - !GetAtt FuncAuthenticate.FunctionId
  #     RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
  #     ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
  #     TypeName: Subscription


  # Func NAME:
  #   Type: AWS::AppSync::FunctionConfiguration
  #   Properties:
  #     ApiId: !GetAtt AppSyncAPI.ApiId
  #     DataSourceName: !GetAtt SOURCE.Name
  #     FunctionVersion: 2018-05-29
  #     Name: NAME
  #     RequestMappingTemplateS3Location: ./Functions/FUNC Request
  #     ResponseMappingTemplateS3Location: ./Functions/FUNC Response
  # Resolver NAME:
  #   Type: AWS::AppSync::Resolver
  #   Properties:
  #     ApiId: !GetAtt AppSyncAPI.ApiId
  #     FieldName: FIELDNAME
  #     Kind: PIPELINE
  #     PipelineConfig:
  #       Functions:
  #         - !GetAtt FuncAuthenticate.FunctionId
  #         - !GetAtt Func NAME.FunctionId
  #     RequestMappingTemplateS3Location: ./Functions/PipelineStandardBeforeRequest
  #     ResponseMappingTemplateS3Location: ./Functions/PipelineStandardAfterResponse
  #     TypeName: Mutation
